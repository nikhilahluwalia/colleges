<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>College Filter</title>
    <link rel="stylesheet" href="college.css">
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 20px;
        }
        .filter-section {
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
            margin-bottom: 20px;
        }
        .filter-category {
            width: 150px;
            margin-bottom: 20px;
        }
        .filter-button {
            display: block;
            padding: 10px;
            background-color: #f0f0f0;
            border: 1px solid #ccc;
            cursor: pointer;
            margin: 5px 0;
            border-radius: 5px;
            text-align: center;
        }
        .filter-button.selected {
            background-color: #007bff;
            color: white;
        }
        .selected-filters {
            margin-bottom: 20px;
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
        }
        .college-card {
            padding: 20px;
            border: 1px solid #ddd;
            margin: 10px;
            border-radius: 5px;
            background-color: #fafafa;
            width: 250px;
            box-sizing: border-box;
        }
        .college-card h3 {
            margin-top: 0;
        }
        .college-card p {
            margin: 5px 0;
        }
        .college-list {
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
            margin-top: 20px;
        }
    </style>
</head>
<body>

<h1>College Filter</h1>

<!-- Selected filters display -->
<div class="selected-filters" id="selected-filters">
    <p>No filters applied.</p>
</div>

<!-- Filter Categories (Location, Budget, etc.) -->
<div class="filter-section" id="filter-section">
    <!-- Dynamic Filters will go here -->
</div>

<!-- Results -->
<div id="results" class="college-list">
    <!-- Matching colleges will be displayed here -->
</div>

<script>
// Fetch filters (like Location, Budget, etc.) dynamically and populate UI
document.addEventListener("DOMContentLoaded", function () {
    const filterSection = document.getElementById("filter-section");
    const resultsContainer = document.getElementById("results");
    const selectedFiltersContainer = document.getElementById("selected-filters");
    let filters = {};

    // Fetch all filter categories dynamically (Location, Budget, etc.)
    fetch('fetch_filters.php')  // Assuming PHP is used for fetching the filter categories from the database
        .then(response => response.json())
        .then(data => {
            // Populate the filter categories section
            for (let category in data) {
                let categoryDiv = document.createElement("div");
                categoryDiv.classList.add("filter-category");
                let categoryTitle = document.createElement("h3");
                categoryTitle.textContent = category;
                categoryDiv.appendChild(categoryTitle);
                
                data[category].forEach(value => {
                    let button = document.createElement("button");
                    button.classList.add("filter-button");
                    button.textContent = value;
                    button.dataset.category = category;
                    button.dataset.value = value;
                    categoryDiv.appendChild(button);
                });

                filterSection.appendChild(categoryDiv);
            }

            // Add event listeners to filter buttons
            document.querySelectorAll(".filter-button").forEach(button => {
                button.addEventListener("click", function () {
                    const category = this.dataset.category;
                    const value = this.dataset.value;
                    handleFilterSelection(category, value, this);
                });
            });
        });

    // Handle filter selection
    function handleFilterSelection(category, value, buttonElement) {
        if (filters[category] && filters[category].includes(value)) {
            // If already selected, remove it
            filters[category] = filters[category].filter(item => item !== value);
            buttonElement.classList.remove("selected");
        } else {
            // Otherwise, add to filter
            if (!filters[category]) filters[category] = [];
            filters[category].push(value);
            buttonElement.classList.add("selected");
        }

        // Update selected filters display
        updateSelectedFilters();
        // Fetch colleges based on selected filters
        fetchFilteredColleges();
    }

    // Update selected filters row
    function updateSelectedFilters() {
        selectedFiltersContainer.innerHTML = "";
        let selectedCount = 0;
        for (let category in filters) {
            filters[category].forEach(value => {
                let filterDisplay = document.createElement("div");
                filterDisplay.textContent = `${category}: ${value}`;
                selectedFiltersContainer.appendChild(filterDisplay);
                selectedCount++;
            });
        }

        if (selectedCount === 0) {
            selectedFiltersContainer.innerHTML = "<p>No filters applied.</p>";
        }
    }

    // Fetch filtered colleges based on selected filters
    function fetchFilteredColleges() {
        let queryString = Object.keys(filters).map(key => `${key}=${encodeURIComponent(filters[key].join(','))}`).join("&");
        fetch(`fetch_colleges.php?${queryString}`)
            .then(response => response.json())
            .then(data => {
                resultsContainer.innerHTML = "";
                if (data.length === 0) {
                    resultsContainer.innerHTML = "<p>No colleges found for the selected filters.</p>";
                } else {
                    data.forEach(college => {
                        let collegeCard = document.createElement("div");
                        collegeCard.classList.add("college-card");
                        collegeCard.innerHTML = `
                            <h3>${college.name}</h3>
                            <p><strong>Location:</strong> ${college.location}</p>
                            <p><strong>Budget:</strong> â‚¹${college.budget}</p>
                            <p><strong>Courses:</strong> ${college.courses}</p>
                            <p><strong>Placement:</strong> ${college.placement}</p>
                            <p><strong>Specialization:</strong> ${college.specialization}</p>
                            <p><strong>Ranking:</strong> ${college.ranking}</p>
                            <p><strong>Facilities:</strong> ${college.facilities}</p>
                        `;
                        resultsContainer.appendChild(collegeCard);
                    });
                }
            })
            .catch(error => {
                console.error("Error fetching colleges:", error);
            });
    }
});
</script>

</body>
</html>

